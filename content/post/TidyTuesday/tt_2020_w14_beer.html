---
title: "TidyTuesday - Beer Production - 2020 - Wk 10"
author: admin
date: '2020-04-07'
slug:  
categories: [Code]
tags:
  - R
  - TidyTuesday
subtitle: ''  
summary: 'A look at beer production'
authors: [M. L. DeBusk-Lane]
lastmod: '2020-04-07T07:57:09-05:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output: 
  html_document:
    theme: journal
    highlight: zenburn

---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>This week’s effort will dive into beer production across America. You may find more informaiton at <a href="https://www.ttb.gov/beer/statistics">Alcohol and Tobacco Tax and Trade Bureau (TTB)</a>.</p>
<pre class="r"><code>library(tidyverse)
library(janitor)
library(readxl)
library(tidylog)
library(ggdark)
library(ggforce)
library(rvest)
library(glue)
library(patchwork)
library(stringi)
library(lubridate)

# Read in the data. 
brewing_materials &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewing_materials.csv&#39;)
beer_taxed &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_taxed.csv&#39;)
brewer_size &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewer_size.csv&#39;)
beer_states &lt;- readr::read_csv(&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_states.csv&#39;)</code></pre>
<p>Let’s begin with a bit of data prep. I’m most interested in how this looks longitudinally, so I used <code>make_date</code> to bring together the year and month into a date variable–primarily for proper sorting.</p>
<pre class="r"><code>hops1 &lt;- brewing_materials %&gt;%
  mutate(date = make_date(year, month)) %&gt;%
  group_by(date, type) %&gt;%
  summarize(avg = mean(month_current)) %&gt;%
  filter(!type %in% c(&#39;Total Grain products&#39;, &#39;Other&#39;, &#39;Total Non-Grain products&#39;, &#39;Total Used&#39;)) </code></pre>
<pre class="r"><code>time_series1 &lt;- hops1 %&gt;%
  ggplot(aes(x = date, y = avg, group = type)) + 
  geom_line(aes(color = type)) + 
  theme(axis.text.x = element_text(angle = 90))
time_series1</code></pre>
<p><img src="/post/TidyTuesday/tt_2020_w14_beer_files/figure-html/unnamed-chunk-3-1.png" width="2400" /></p>
<p>Clearly something does not look right after 2016. From what I can find, it appears they changed the reporting criteria or structure. Although I was looking for some type of diverging trend to indicate a change in types of beer popularity (my hypothesis), I’m not sure that is evident. The <code>Hops (dry)</code> variable obviously does something crazy in 2015-2016, but I’m not sure I trust that much of an increase beween 2014 and 2015 either.</p>
<p>Nevertheless, lets keep going with an effort now towards modeling this time series between 2008 and the end of 2014 (somewhat cleanish/valid data). Just to zoom in a bit, I’d like to examine the seasonality of <code>Malt and malt products</code>.</p>
<pre class="r"><code>hops2 &lt;- brewing_materials %&gt;%
  mutate(date = make_date(year, month)) %&gt;%
  filter(date &gt;= &#39;2008-01-01&#39; &amp; date &lt;= &#39;2014-01-01&#39;) %&gt;%
  group_by(date, type) %&gt;%  
  summarize(avg = mean(month_current)) %&gt;% ungroup() %&gt;%
  filter(type == &#39;Malt and malt products&#39;) %&gt;%
  mutate(date = ymd(date, truncated = 1))</code></pre>
<p>Let’s take a look with just this vantage.</p>
<pre class="r"><code>time_series2 &lt;- hops2 %&gt;%
  ggplot(aes(x = date, y = avg, group = type)) + 
  geom_line(aes(color = type)) + 
  theme(axis.text.x = element_text(angle = 90))
time_series2</code></pre>
<p><img src="/post/TidyTuesday/tt_2020_w14_beer_files/figure-html/unnamed-chunk-5-1.png" width="2400" /></p>
<pre class="r"><code>class(hops2)</code></pre>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>To model this, I’d like to push this time series into a <code>tsibble</code> to classify it as temporal data.</p>
<pre class="r"><code>library(tsibble)
tsibble &lt;- as_tsibble(hops2, index = date, key = type)</code></pre>
<pre class="r"><code>class(tsibble$date)</code></pre>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>I fought with this for a good while. Lesson learned. Although this variable <code>ts$date</code> identifies as a ‘Date’ variable, it is not in the right or correct interval.</p>
<p>Lets take a look. Notice the structure of the <code>date</code> variable below, it is in `%Y-%m-%d’.</p>
<p>In the end, this forecasts daily, not monthly. We must coerce this variable’s interval as a month.</p>
<pre class="r"><code>head(tsibble)</code></pre>
<pre><code>## # A tsibble: 6 x 3 [1D]
## # Key:       type [1]
##   date       type                         avg
##   &lt;date&gt;     &lt;chr&gt;                      &lt;dbl&gt;
## 1 2008-01-01 Malt and malt products 374165152
## 2 2008-02-01 Malt and malt products 355687578
## 3 2008-03-01 Malt and malt products 399855819
## 4 2008-04-01 Malt and malt products 388639443
## 5 2008-05-01 Malt and malt products 411307544
## 6 2008-06-01 Malt and malt products 415161326</code></pre>
<p>In this instance, I knew I wanted to use the <code>forecastLM</code> developmental package which takes a tsibble or ts object. However, it does not have internal checks to determine your data align with the interval for which you’ve situated.</p>
<p>In my case, I did not originally situate an interval for the tsibble object I created and ran into problems during forecasting.</p>
<p>How to set a <code>year month</code> interval in tsibble using the <code>yearmonth</code> function:</p>
<pre class="r"><code>tsibble &lt;- tsibble %&gt;%
  mutate(date = yearmonth(date))</code></pre>
<pre class="r"><code>class(tsibble$date)</code></pre>
<pre><code>## [1] &quot;yearmonth&quot; &quot;Date&quot;</code></pre>
<p>This allows forecastLM to make predictions on a monthly basis, not daily…</p>
<pre class="r"><code>class(tsibble)</code></pre>
<pre><code>## [1] &quot;tbl_ts&quot;     &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<p>Visualize using the TSstudio package from <code>Rami Krispin</code>, which takes a ts object as input for graphics. So lets make a ts object, as opposed to the tsibble.</p>
<pre class="r"><code>library(TSstudio) 
seasonal &lt;- ts(data = tsibble$avg, start = c(2008, 1), end = c(2014, 1), frequency = 12)
ts_plot(seasonal,
        line.mode = &quot;lines+markers&quot;,
        Ygrid = T, slider = T,
        title = &quot;Malts Over Time&quot;,
        Ytitle = &quot;Millions of Barrels&quot;)</code></pre>
<div id="htmlwidget-1" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"1039761b3454":["function () ","plotlyVisDat"]},"cur_data":"1039761b3454","attrs":{"1039761b3454":{"x":{},"y":{},"mode":"lines+markers","marker":{"color":"#00526d"},"line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"rangeslider":{"type":"date"},"title":"","showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"Millions of Barrels","showgrid":true},"title":"Malts Over Time","hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[2008,2008.08333333333,2008.16666666667,2008.25,2008.33333333333,2008.41666666667,2008.5,2008.58333333333,2008.66666666667,2008.75,2008.83333333333,2008.91666666667,2009,2009.08333333333,2009.16666666667,2009.25,2009.33333333333,2009.41666666667,2009.5,2009.58333333333,2009.66666666667,2009.75,2009.83333333333,2009.91666666667,2010,2010.08333333333,2010.16666666667,2010.25,2010.33333333333,2010.41666666667,2010.5,2010.58333333333,2010.66666666667,2010.75,2010.83333333333,2010.91666666667,2011,2011.08333333333,2011.16666666667,2011.25,2011.33333333333,2011.41666666667,2011.5,2011.58333333333,2011.66666666667,2011.75,2011.83333333333,2011.91666666667,2012,2012.08333333333,2012.16666666667,2012.25,2012.33333333333,2012.41666666667,2012.5,2012.58333333333,2012.66666666667,2012.75,2012.83333333333,2012.91666666667,2013,2013.08333333333,2013.16666666667,2013.25,2013.33333333333,2013.41666666667,2013.5,2013.58333333333,2013.66666666667,2013.75,2013.83333333333,2013.91666666667,2014],"y":[374165152,355687578,399855819,388639443,411307544,415161326,405393784,389391266,362587470,353803777,322733711,318741733,361377478,339472713,380133298,384396702,391469434,381247341,382672919,362521445,370369895,333286901,309688888,302237874,330304432,305543380,366733254,374018118,399504457,380521275,384726834,358726926,329671455,333230020,298251207,285382073,322480722,307076591,363234183,349781343,352623620,372541998,350751002,361924350,312845217,313380880,303152329,293640890,315214803,320430694,366122047,357106000,373071360,387306474,363222892,362799587,336789908,321542825,295672895,299861553,326450615,311283986,340319408,334351807,353589770,370101067,367999200,339968116,303711377,321371392,275715285,294248188,315728713],"mode":"lines+markers","marker":{"color":"#00526d","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ts_cor(seasonal, seasonal_lags = 12, lag.max = 60)</code></pre>
<div id="htmlwidget-2" style="width:2400px;height:2100px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.1,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[12,24,36,48,60],"y":[0.669115902333412,0.497112133340483,0.297433122032514,0.175159233940173,0.0377608318926634],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.1,0.1,0.1,0.1,0.1],"legendgroup":"seasonal","name":"Seasonal Lag 12","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,55,56,57,58,59],"y":[0.734697103217122,0.567066811315593,0.218132695254762,-0.0987375205454956,-0.301969528173709,-0.415831174172146,-0.31027740456386,-0.156306897359938,0.110125921138593,0.391157814544496,0.509513756497439,0.508831984724011,0.36381585461881,0.0767247613079174,-0.183944553560914,-0.361011977487972,-0.457039049104464,-0.373762346407727,-0.242074230713635,0.00779111941702062,0.252538509299616,0.388247735007226,0.356056126798708,0.259383256869884,0.0205346395920477,-0.185465917833588,-0.318285316546839,-0.40046551230227,-0.333544428360518,-0.239011114753798,-0.0486939472632344,0.11790425574306,0.208151606429738,0.196313878802528,0.106781565760431,-0.0530156051300366,-0.21740787197791,-0.291340965778773,-0.356888451853333,-0.28928653253362,-0.210693734851861,-0.0483786088157989,0.0675557078175607,0.132367656805006,0.123163391465237,0.056042708785691,-0.0365309218935674,-0.135629794609498,-0.181833809884028,-0.232150473862048,-0.215270495776952,-0.192750487095751,-0.102587462378841,-0.0469382963531487,-0.000276314162045291],"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"width":[0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1],"legendgroup":"nonseasonal","name":"Non-Seasonal","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,60],"y":[0.229396433213667,0.229396433213667],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,60],"y":[-0.229396433213667,-0.229396433213667],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[12,24,36,48,60],"y":[0.260203482721538,-0.0607478405505391,-0.0044439107623704,-0.0309978363533423,-0.0589113199844953],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.1,0.1,0.1,0.1,0.1],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 12","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,29,30,31,32,33,34,35,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,55,56,57,58,59],"y":[0.734697103217122,0.0592911389477709,-0.473937151221543,-0.356570534944484,0.0746948601739357,0.124432054314411,0.29692374904367,0.117309504130273,0.101810704149919,0.263937950171058,-0.109889779877074,-0.199338074494496,-0.105841550681181,-0.0578416823450321,-0.0327339683391933,-0.0218454492045056,0.017296778096124,-0.0428456999103503,-0.0523727164574306,0.0989934346441969,0.0349267620621356,0.0111421087811742,-0.201096930231912,0.202987801025471,0.150767907312968,-0.0799913645045783,-0.0303613666301219,-0.0752476544570691,-0.0369042117669337,0.0449121265557005,-0.0737914318644765,-0.121427114213331,-0.0957618897045424,0.100244618503092,-0.0645326113220423,-0.0194038868742756,-0.0806183731197043,0.0876531293864896,0.0323943984836702,0.0111440676241989,-0.0592909882689159,0.00843720304078719,-0.0363160391459163,0.0320036636042916,0.0637641747113591,-0.0105462525249747,0.0395380567139963,0.0339497565242603,-0.0719655482428934,-0.10051267843358,-0.183334393422308,-0.0275493473364951,0.11307058043584,-0.00866915485330659,-0.141163607566568],"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"width":[0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1],"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,60],"y":[0.229396433213667,0.229396433213667],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,60],"y":[-0.229396433213667,-0.229396433213667],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":12,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.48],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"seasonal ACF and PACF Plots"},"attrs":{"103967385d7c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.1,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"103967385d7c.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"y":[null,null,null,null,null,null,null,null,null,null,null,null,0.669115902333412,null,null,null,null,null,null,null,null,null,null,null,0.497112133340483,null,null,null,null,null,null,null,null,null,null,null,0.297433122032514,null,null,null,null,null,null,null,null,null,null,null,0.175159233940173,null,null,null,null,null,null,null,null,null,null,null,0.0377608318926634],"type":"bar","marker":{"color":"red"},"width":0.1,"legendgroup":"seasonal","name":"Seasonal Lag 12","inherit":true},"103967385d7c.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"y":[null,0.734697103217122,0.567066811315593,0.218132695254762,-0.0987375205454956,-0.301969528173709,-0.415831174172146,-0.31027740456386,-0.156306897359938,0.110125921138593,0.391157814544496,0.509513756497439,null,0.508831984724011,0.36381585461881,0.0767247613079174,-0.183944553560914,-0.361011977487972,-0.457039049104464,-0.373762346407727,-0.242074230713635,0.00779111941702062,0.252538509299616,0.388247735007226,null,0.356056126798708,0.259383256869884,0.0205346395920477,-0.185465917833588,-0.318285316546839,-0.40046551230227,-0.333544428360518,-0.239011114753798,-0.0486939472632344,0.11790425574306,0.208151606429738,null,0.196313878802528,0.106781565760431,-0.0530156051300366,-0.21740787197791,-0.291340965778773,-0.356888451853333,-0.28928653253362,-0.210693734851861,-0.0483786088157989,0.0675557078175607,0.132367656805006,null,0.123163391465237,0.056042708785691,-0.0365309218935674,-0.135629794609498,-0.181833809884028,-0.232150473862048,-0.215270495776952,-0.192750487095751,-0.102587462378841,-0.0469382963531487,-0.000276314162045291,null],"type":"bar","marker":{"color":"#00526d"},"width":0.1,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"103967385d7c.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.229396433213667,"xend":60,"yend":0.229396433213667,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"103967385d7c.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.229396433213667,"xend":60,"yend":-0.229396433213667,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"10392581acd5":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"y":[null,null,null,null,null,null,null,null,null,null,null,0.260203482721538,null,null,null,null,null,null,null,null,null,null,null,-0.0607478405505391,null,null,null,null,null,null,null,null,null,null,null,-0.0044439107623704,null,null,null,null,null,null,null,null,null,null,null,-0.0309978363533423,null,null,null,null,null,null,null,null,null,null,null,-0.0589113199844953],"type":"bar","marker":{"color":"red"},"width":0.1,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 12","inherit":true},"10392581acd5.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60],"y":[0.734697103217122,0.0592911389477709,-0.473937151221543,-0.356570534944484,0.0746948601739357,0.124432054314411,0.29692374904367,0.117309504130273,0.101810704149919,0.263937950171058,-0.109889779877074,null,-0.199338074494496,-0.105841550681181,-0.0578416823450321,-0.0327339683391933,-0.0218454492045056,0.017296778096124,-0.0428456999103503,-0.0523727164574306,0.0989934346441969,0.0349267620621356,0.0111421087811742,null,-0.201096930231912,0.202987801025471,0.150767907312968,-0.0799913645045783,-0.0303613666301219,-0.0752476544570691,-0.0369042117669337,0.0449121265557005,-0.0737914318644765,-0.121427114213331,-0.0957618897045424,null,0.100244618503092,-0.0645326113220423,-0.0194038868742756,-0.0806183731197043,0.0876531293864896,0.0323943984836702,0.0111440676241989,-0.0592909882689159,0.00843720304078719,-0.0363160391459163,0.0320036636042916,null,0.0637641747113591,-0.0105462525249747,0.0395380567139963,0.0339497565242603,-0.0719655482428934,-0.10051267843358,-0.183334393422308,-0.0275493473364951,0.11307058043584,-0.00866915485330659,-0.141163607566568,null],"type":"bar","marker":{"color":"#00526d"},"width":0.1,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"10392581acd5.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.229396433213667,"xend":60,"yend":0.229396433213667,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"10392581acd5.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.229396433213667,"xend":60,"yend":-0.229396433213667,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ts_seasonal(seasonal, type = &quot;all&quot;)</code></pre>
<div id="htmlwidget-3" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"data":[{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[374165152,355687578,399855819,388639443,411307544,415161326,405393784,389391266,362587470,353803777,322733711,318741733],"type":"scatter","mode":"lines","name":"2008","line":{"color":"#440154FF"},"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[361377478,339472713,380133298,384396702,391469434,381247341,382672919,362521445,370369895,333286901,309688888,302237874],"type":"scatter","mode":"lines","name":"2009","line":{"color":"#443A83FF"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[330304432,305543380,366733254,374018118,399504457,380521275,384726834,358726926,329671455,333230020,298251207,285382073],"type":"scatter","mode":"lines","name":"2010","line":{"color":"#31688EFF"},"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[322480722,307076591,363234183,349781343,352623620,372541998,350751002,361924350,312845217,313380880,303152329,293640890],"type":"scatter","mode":"lines","name":"2011","line":{"color":"#21908CFF"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[315214803,320430694,366122047,357106000,373071360,387306474,363222892,362799587,336789908,321542825,295672895,299861553],"type":"scatter","mode":"lines","name":"2012","line":{"color":"#35B779FF"},"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[326450615,311283986,340319408,334351807,353589770,370101067,367999200,339968116,303711377,321371392,275715285,294248188],"type":"scatter","mode":"lines","name":"2013","line":{"color":"#8FD744FF"},"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan"],"y":[315728713],"type":"scatter","mode":"lines","name":"2014","line":{"color":"#FDE725FF"},"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2008,2009,2010,2011,2012,2013,2014],"y":[374165152,361377478,330304432,322480722,315214803,326450615,315728713],"type":"scatter","mode":"lines","name":"Jan","line":{"color":"#E41A1C"},"showlegend":true,"legendgroup":"all_Jan","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[355687578,339472713,305543380,307076591,320430694,311283986],"type":"scatter","mode":"lines","name":"Feb","line":{"color":"#66628D"},"showlegend":true,"legendgroup":"all_Feb","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[399855819,380133298,366733254,363234183,366122047,340319408],"type":"scatter","mode":"lines","name":"Mar","line":{"color":"#419486"},"showlegend":true,"legendgroup":"all_Mar","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[388639443,384396702,374018118,349781343,357106000,334351807],"type":"scatter","mode":"lines","name":"Apr","line":{"color":"#5A9D5A"},"showlegend":true,"legendgroup":"all_Apr","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[411307544,391469434,399504457,352623620,373071360,353589770],"type":"scatter","mode":"lines","name":"May","line":{"color":"#91569A"},"showlegend":true,"legendgroup":"all_May","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[415161326,381247341,380521275,372541998,387306474,370101067],"type":"scatter","mode":"lines","name":"Jun","line":{"color":"#D96D3B"},"showlegend":true,"legendgroup":"all_Jun","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[405393784,382672919,384726834,350751002,363222892,367999200],"type":"scatter","mode":"lines","name":"Jul","line":{"color":"#FFAD12"},"showlegend":true,"legendgroup":"all_Jul","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[389391266,362521445,358726926,361924350,362799587,339968116],"type":"scatter","mode":"lines","name":"Aug","line":{"color":"#F6EF32"},"showlegend":true,"legendgroup":"all_Aug","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[362587470,370369895,329671455,312845217,336789908,303711377],"type":"scatter","mode":"lines","name":"Sep","line":{"color":"#B6742A"},"showlegend":true,"legendgroup":"all_Sep","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[353803777,333286901,333230020,313380880,321542825,321371392],"type":"scatter","mode":"lines","name":"Oct","line":{"color":"#D26D7A"},"showlegend":true,"legendgroup":"all_Oct","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[322733711,309688888,298251207,303152329,295672895,275715285],"type":"scatter","mode":"lines","name":"Nov","line":{"color":"#DD87B4"},"showlegend":true,"legendgroup":"all_Nov","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[2008,2009,2010,2011,2012,2013],"y":[318741733,302237874,285382073,293640890,299861553,294248188],"type":"scatter","mode":"lines","name":"Dec","line":{"color":"#999999"},"showlegend":true,"legendgroup":"all_Dec","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"fillcolor":"rgba(228,26,28, 0.5)","y":[374165152,361377478,330304432,322480722,315214803,326450615,315728713],"type":"box","line":{"color":"#E41A1C"},"marker":{"color":"#E41A1C","line":{"color":"rgba(23,190,207,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Jan","showlegend":false,"legendgroup":"all_Jan","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(102,98,141, 0.5)","y":[355687578,339472713,305543380,307076591,320430694,311283986],"type":"box","line":{"color":"#66628D"},"marker":{"color":"#66628D","line":{"color":"rgba(31,119,180,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Feb","showlegend":false,"legendgroup":"all_Feb","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(65,148,134, 0.5)","y":[399855819,380133298,366733254,363234183,366122047,340319408],"type":"box","line":{"color":"#419486"},"marker":{"color":"#419486","line":{"color":"rgba(255,127,14,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Mar","showlegend":false,"legendgroup":"all_Mar","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(90,157,90, 0.5)","y":[388639443,384396702,374018118,349781343,357106000,334351807],"type":"box","line":{"color":"#5A9D5A"},"marker":{"color":"#5A9D5A","line":{"color":"rgba(44,160,44,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Apr","showlegend":false,"legendgroup":"all_Apr","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(145,86,154, 0.5)","y":[411307544,391469434,399504457,352623620,373071360,353589770],"type":"box","line":{"color":"#91569A"},"marker":{"color":"#91569A","line":{"color":"rgba(214,39,40,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"May","showlegend":false,"legendgroup":"all_May","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(217,109,59, 0.5)","y":[415161326,381247341,380521275,372541998,387306474,370101067],"type":"box","line":{"color":"#D96D3B"},"marker":{"color":"#D96D3B","line":{"color":"rgba(148,103,189,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Jun","showlegend":false,"legendgroup":"all_Jun","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(255,173,18, 0.5)","y":[405393784,382672919,384726834,350751002,363222892,367999200],"type":"box","line":{"color":"#FFAD12"},"marker":{"color":"#FFAD12","line":{"color":"rgba(140,86,75,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Jul","showlegend":false,"legendgroup":"all_Jul","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(246,239,50, 0.5)","y":[389391266,362521445,358726926,361924350,362799587,339968116],"type":"box","line":{"color":"#F6EF32"},"marker":{"color":"#F6EF32","line":{"color":"rgba(227,119,194,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Aug","showlegend":false,"legendgroup":"all_Aug","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(182,116,42, 0.5)","y":[362587470,370369895,329671455,312845217,336789908,303711377],"type":"box","line":{"color":"#B6742A"},"marker":{"color":"#B6742A","line":{"color":"rgba(127,127,127,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Sep","showlegend":false,"legendgroup":"all_Sep","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(210,109,122, 0.5)","y":[353803777,333286901,333230020,313380880,321542825,321371392],"type":"box","line":{"color":"#D26D7A"},"marker":{"color":"#D26D7A","line":{"color":"rgba(188,189,34,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Oct","showlegend":false,"legendgroup":"all_Oct","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(221,135,180, 0.5)","y":[322733711,309688888,298251207,303152329,295672895,275715285],"type":"box","line":{"color":"#DD87B4"},"marker":{"color":"#DD87B4","line":{"color":"rgba(23,190,207,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Nov","showlegend":false,"legendgroup":"all_Nov","xaxis":"x3","yaxis":"y3","frame":null},{"fillcolor":"rgba(153,153,153, 0.5)","y":[318741733,302237874,285382073,293640890,299861553,294248188],"type":"box","line":{"color":"#999999"},"marker":{"color":"#999999","line":{"color":"rgba(31,119,180,1)"}},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Dec","showlegend":false,"legendgroup":"all_Dec","xaxis":"x3","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"category","categoryorder":"array","categoryarray":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"anchor":"y2"},"xaxis3":{"domain":[0,1],"automargin":true,"anchor":"y3"},"yaxis3":{"domain":[0,0.313333333333333],"automargin":true,"title":"By Frequency Unit","anchor":"x3"},"yaxis2":{"domain":[0.353333333333333,0.646666666666667],"automargin":true,"title":"By Frequency Unit","anchor":"x2"},"yaxis":{"domain":[0.686666666666667,1],"automargin":true,"title":"By Frequency Cycle","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":true,"title":"Seasonality Plot - seasonal"},"attrs":{"10397f38f231":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[374165152,355687578,399855819,388639443,411307544,415161326,405393784,389391266,362587470,353803777,322733711,318741733],"type":"scatter","mode":"lines","name":2008,"line":{"color":"#440154FF"},"inherit":true},"10397f38f231.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[361377478,339472713,380133298,384396702,391469434,381247341,382672919,362521445,370369895,333286901,309688888,302237874],"type":"scatter","mode":"lines","name":2009,"line":{"color":"#443A83FF"},"inherit":true},"10397f38f231.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[330304432,305543380,366733254,374018118,399504457,380521275,384726834,358726926,329671455,333230020,298251207,285382073],"type":"scatter","mode":"lines","name":2010,"line":{"color":"#31688EFF"},"inherit":true},"10397f38f231.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[322480722,307076591,363234183,349781343,352623620,372541998,350751002,361924350,312845217,313380880,303152329,293640890],"type":"scatter","mode":"lines","name":2011,"line":{"color":"#21908CFF"},"inherit":true},"10397f38f231.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[315214803,320430694,366122047,357106000,373071360,387306474,363222892,362799587,336789908,321542825,295672895,299861553],"type":"scatter","mode":"lines","name":2012,"line":{"color":"#35B779FF"},"inherit":true},"10397f38f231.5":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[326450615,311283986,340319408,334351807,353589770,370101067,367999200,339968116,303711377,321371392,275715285,294248188],"type":"scatter","mode":"lines","name":2013,"line":{"color":"#8FD744FF"},"inherit":true},"10397f38f231.6":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":"Jan","y":315728713,"type":"scatter","mode":"lines","name":2014,"line":{"color":"#FDE725FF"},"inherit":true},"103973a4b037":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[374165152,361377478,330304432,322480722,315214803,326450615,315728713],"type":"scatter","mode":"lines","name":"Jan","line":{"color":"#E41A1C"},"showlegend":true,"legendgroup":"all_Jan","inherit":true},"103973a4b037.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[355687578,339472713,305543380,307076591,320430694,311283986,null],"type":"scatter","mode":"lines","name":"Feb","line":{"color":"#66628D"},"showlegend":true,"legendgroup":"all_Feb","inherit":true},"103973a4b037.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[399855819,380133298,366733254,363234183,366122047,340319408,null],"type":"scatter","mode":"lines","name":"Mar","line":{"color":"#419486"},"showlegend":true,"legendgroup":"all_Mar","inherit":true},"103973a4b037.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[388639443,384396702,374018118,349781343,357106000,334351807,null],"type":"scatter","mode":"lines","name":"Apr","line":{"color":"#5A9D5A"},"showlegend":true,"legendgroup":"all_Apr","inherit":true},"103973a4b037.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[411307544,391469434,399504457,352623620,373071360,353589770,null],"type":"scatter","mode":"lines","name":"May","line":{"color":"#91569A"},"showlegend":true,"legendgroup":"all_May","inherit":true},"103973a4b037.5":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[415161326,381247341,380521275,372541998,387306474,370101067,null],"type":"scatter","mode":"lines","name":"Jun","line":{"color":"#D96D3B"},"showlegend":true,"legendgroup":"all_Jun","inherit":true},"103973a4b037.6":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[405393784,382672919,384726834,350751002,363222892,367999200,null],"type":"scatter","mode":"lines","name":"Jul","line":{"color":"#FFAD12"},"showlegend":true,"legendgroup":"all_Jul","inherit":true},"103973a4b037.7":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[389391266,362521445,358726926,361924350,362799587,339968116,null],"type":"scatter","mode":"lines","name":"Aug","line":{"color":"#F6EF32"},"showlegend":true,"legendgroup":"all_Aug","inherit":true},"103973a4b037.8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[362587470,370369895,329671455,312845217,336789908,303711377,null],"type":"scatter","mode":"lines","name":"Sep","line":{"color":"#B6742A"},"showlegend":true,"legendgroup":"all_Sep","inherit":true},"103973a4b037.9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[353803777,333286901,333230020,313380880,321542825,321371392,null],"type":"scatter","mode":"lines","name":"Oct","line":{"color":"#D26D7A"},"showlegend":true,"legendgroup":"all_Oct","inherit":true},"103973a4b037.10":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[322733711,309688888,298251207,303152329,295672895,275715285,null],"type":"scatter","mode":"lines","name":"Nov","line":{"color":"#DD87B4"},"showlegend":true,"legendgroup":"all_Nov","inherit":true},"103973a4b037.11":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[2008,2009,2010,2011,2012,2013,2014],"y":[318741733,302237874,285382073,293640890,299861553,294248188,null],"type":"scatter","mode":"lines","name":"Dec","line":{"color":"#999999"},"showlegend":true,"legendgroup":"all_Dec","inherit":true},"10397b267c64":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(228,26,28, 0.5)","line":{"color":"#E41A1C"},"marker":{"color":"#E41A1C"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Jan","showlegend":false,"legendgroup":"all_Jan","inherit":true},"10391bb0c866":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(102,98,141, 0.5)","line":{"color":"#66628D"},"marker":{"color":"#66628D"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Feb","showlegend":false,"legendgroup":"all_Feb","inherit":true},"10397334aebd":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(65,148,134, 0.5)","line":{"color":"#419486"},"marker":{"color":"#419486"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Mar","showlegend":false,"legendgroup":"all_Mar","inherit":true},"10397bc3562":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(90,157,90, 0.5)","line":{"color":"#5A9D5A"},"marker":{"color":"#5A9D5A"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Apr","showlegend":false,"legendgroup":"all_Apr","inherit":true},"10395554b8e5":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(145,86,154, 0.5)","line":{"color":"#91569A"},"marker":{"color":"#91569A"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"May","showlegend":false,"legendgroup":"all_May","inherit":true},"10392d36ee27":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(217,109,59, 0.5)","line":{"color":"#D96D3B"},"marker":{"color":"#D96D3B"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Jun","showlegend":false,"legendgroup":"all_Jun","inherit":true},"1039714d59a1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(255,173,18, 0.5)","line":{"color":"#FFAD12"},"marker":{"color":"#FFAD12"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Jul","showlegend":false,"legendgroup":"all_Jul","inherit":true},"1039d379324":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(246,239,50, 0.5)","line":{"color":"#F6EF32"},"marker":{"color":"#F6EF32"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Aug","showlegend":false,"legendgroup":"all_Aug","inherit":true},"10393b9d2743":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(182,116,42, 0.5)","line":{"color":"#B6742A"},"marker":{"color":"#B6742A"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Sep","showlegend":false,"legendgroup":"all_Sep","inherit":true},"10394a7cbe48":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(210,109,122, 0.5)","line":{"color":"#D26D7A"},"marker":{"color":"#D26D7A"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Oct","showlegend":false,"legendgroup":"all_Oct","inherit":true},"103943b08f2c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(221,135,180, 0.5)","line":{"color":"#DD87B4"},"marker":{"color":"#DD87B4"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Nov","showlegend":false,"legendgroup":"all_Nov","inherit":true},"10397c87b46b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"y":{},"type":"box","fillcolor":"rgba(153,153,153, 0.5)","line":{"color":"#999999"},"marker":{"color":"#999999"},"boxpoints":"all","jitter":0.3,"pointpos":-1.8,"name":"Dec","showlegend":false,"legendgroup":"all_Dec","inherit":true}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>From this, it appears there is a strong montly sesonality–with a bit of variability. However, there does appear to be a noticable decline across the entire year as time moves. This trend is also evident in the plot above this one, whereby there appears to be a fairly linear decline over time.</p>
<p>I’ll use a developmental R package <code>forecastLM</code> to examine this trend. You can find more details <a href="https://github.com/RamiKrispin/forecastLM">here</a>.</p>
<pre class="r"><code>library(forecastLM)
lm1 &lt;- trainLM(input = tsibble,
               y = &quot;avg&quot;,
               trend = list(linear = TRUE),
               seasonal = &quot;month&quot;)</code></pre>
<pre class="r"><code>summary(lm1$model)</code></pre>
<pre><code>## 
## Call:
## stats::lm(formula = f, data = df1)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -23476646  -8276435   1060833   8795520  21891713 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  360761182    4978760  72.460  &lt; 2e-16 ***
## monthFeb     -15321278    6431251  -2.382   0.0204 *  
## monthMar      31522694    6428313   4.904 7.51e-06 ***
## monthApr      27532056    6426027   4.284 6.73e-05 ***
## monthMay      43770978    6424394   6.813 5.20e-09 ***
## monthJun      48683322    6423414   7.579 2.57e-10 ***
## monthJul      40691308    6423087   6.335 3.36e-08 ***
## monthAug      28145612    6423414   4.382 4.81e-05 ***
## monthSep       2279678    6424394   0.355   0.7239    
## monthOct      -3586782    6426027  -0.558   0.5788    
## monthNov     -31460235    6428313  -4.894 7.78e-06 ***
## monthDec     -32617108    6431251  -5.072 4.07e-06 ***
## linear_trend   -693461      64790 -10.703 1.53e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11550000 on 60 degrees of freedom
## Multiple R-squared:  0.9038, Adjusted R-squared:  0.8846 
## F-statistic:    47 on 12 and 60 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>lm1.1 &lt;- trainLM(input = seasonal,
               y = &quot;avg&quot;,
               trend = list(linear = TRUE),
               seasonal = &quot;month&quot;)</code></pre>
<pre class="r"><code>summary(lm1.1$model)</code></pre>
<pre><code>## 
## Call:
## stats::lm(formula = f, data = df1)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -23476646  -8276435   1060833   8795520  21891713 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  360761182    4978760  72.460  &lt; 2e-16 ***
## monthFeb     -15321278    6431251  -2.382   0.0204 *  
## monthMar      31522694    6428313   4.904 7.51e-06 ***
## monthApr      27532056    6426027   4.284 6.73e-05 ***
## monthMay      43770978    6424394   6.813 5.20e-09 ***
## monthJun      48683322    6423414   7.579 2.57e-10 ***
## monthJul      40691308    6423087   6.335 3.36e-08 ***
## monthAug      28145612    6423414   4.382 4.81e-05 ***
## monthSep       2279678    6424394   0.355   0.7239    
## monthOct      -3586782    6426027  -0.558   0.5788    
## monthNov     -31460235    6428313  -4.894 7.78e-06 ***
## monthDec     -32617108    6431251  -5.072 4.07e-06 ***
## linear_trend   -693461      64790 -10.703 1.53e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11550000 on 60 degrees of freedom
## Multiple R-squared:  0.9038, Adjusted R-squared:  0.8846 
## F-statistic:    47 on 12 and 60 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>plot_res(lm1.1)</code></pre>
<div id="htmlwidget-4" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"data":[{"x":["2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[374165152,355687578,399855819,388639443,411307544,415161326,405393784,389391266,362587470,353803777,322733711,318741733,361377478,339472713,380133298,384396702,391469434,381247341,382672919,362521445,370369895,333286901,309688888,302237874,330304432,305543380,366733254,374018118,399504457,380521275,384726834,358726926,329671455,333230020,298251207,285382073,322480722,307076591,363234183,349781343,352623620,372541998,350751002,361924350,312845217,313380880,303152329,293640890,315214803,320430694,366122047,357106000,373071360,387306474,363222892,362799587,336789908,321542825,295672895,299861553,326450615,311283986,340319408,334351807,353589770,370101067,367999200,339968116,303711377,321371392,275715285,294248188,315728713],"mode":"lines","name":"Actual","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[360067720.782313,344052982.05669,390203493.223356,385519393.890023,401064855.890023,405283738.55669,396598263.55669,383359106.723356,356799712.05669,350239790.890023,321672877.55669,319822543.55669,351746190.759638,335731452.034014,381881963.20068,377197863.867347,392743325.867347,396962208.534014,388276733.534014,375037576.70068,348478182.034014,341918260.867347,313351347.534014,311501013.534014,343424660.736962,327409922.011338,373560433.178005,368876333.844671,384421795.844671,388640678.511338,379955203.511338,366716046.678005,340156652.011338,333596730.844671,305029817.511338,303179483.511338,335103130.714286,319088391.988662,365238903.155329,360554803.821996,376100265.821996,380319148.488662,371633673.488662,358394516.655329,331835121.988662,325275200.821996,296708287.488662,294857953.488662,326781600.69161,310766861.965987,356917373.132653,352233273.79932,367778735.79932,371997618.465987,363312143.465987,350072986.632653,323513591.965987,316953670.79932,288386757.465987,286536423.465987,318460070.668935,302445331.943311,348595843.109977,343911743.776644,359457205.776644,363676088.443311,354990613.443311,341751456.609977,315192061.943311,308632140.776644,280065227.443311,278214893.443311,310138540.646259],"mode":"lines","name":"Fitted","type":"scatter","line":{"color":"red","dash":"dash"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[14097431.2176867,11634595.9433104,9652325.77664381,3120049.10997707,10242688.1099771,9877587.44331044,8795520.44331044,6032159.27664381,5787757.94331044,3563986.10997713,1060833.4433105,-1080810.55668956,9631287.24036241,3741260.96598619,-1748665.20068043,7198838.13265282,-1273891.86734712,-15714867.5340138,-5603814.53401381,-12516131.7006804,21891712.9659862,-8631359.86734712,-3662459.53401375,-9263139.53401381,-13120228.7369618,-21866542.0113381,-6827179.17800468,5141784.15532857,15082661.1553286,-8119403.51133806,4771630.48866194,-7989120.67800474,-10485197.0113381,-366710.844671369,-6778610.511338,-17797410.5113381,-12622408.7142861,-12011800.9886624,-2004720.15532893,-10773460.8219957,-23476645.8219957,-7777150.4886623,-20882671.4886623,3529833.34467101,-18989904.9886623,-11894320.8219956,6444041.5113377,-1217063.4886623,-11566797.6916103,9663832.03401339,9204673.86734682,4872726.20068008,5292624.20068008,15308855.5340135,-89251.4659865499,12726600.3673468,13276316.0340135,4589154.20068014,7286137.53401345,13325129.5340135,7990544.33106542,8838654.05668914,-8276435.10997742,-9559936.77664417,-5867435.77664417,6424978.5566892,13008586.5566892,-1783340.60997748,-11480684.9433108,12739251.2233559,-4349942.4433108,16033294.5566892,5590172.35374117],"mode":"lines","line":{"color":"green"},"name":"Residuals","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[1,0.33126502674405,0.316995943571457,0.240073614803022,0.247691761528387,0.236060873636704,0.272982265289439,0.164059091769214,0.204714652155113,-0.0348937849493773,0.108812528224433,-0.0536821398227001,-0.042306858897919,-0.0102403596093093,-0.0891823138272538,-0.03225024493814,-0.0216389503102395,-0.165259521103126,-0.0292133640767686,-0.0292865711878769,-0.0704770695413403,-0.121286792943834,-0.0644195380204774,0.0547983813088495,-0.225920230310414,-0.140515222111064,-0.0450092616878596,-0.134368835767655,-0.0712066671897704,-0.189893724247035,-0.20833053160136,-0.172990197478654,-0.236939318593149,-0.143754860643341,-0.284996451510476,-0.262736898961647,-0.240299900925912],"type":"bar","width":[0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01],"showlegend":false,"marker":{"color":"#00526d","line":{"color":"#00526d"}},"name":"Autocorrelation","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667,0.229396433213667],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":1},"showlegend":false,"name":"CI Upper","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667,-0.229396433213667],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":1},"showlegend":false,"name":"CI Lower","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[14097431.2176867,11634595.9433104,9652325.77664381,3120049.10997707,10242688.1099771,9877587.44331044,8795520.44331044,6032159.27664381,5787757.94331044,3563986.10997713,1060833.4433105,-1080810.55668956,9631287.24036241,3741260.96598619,-1748665.20068043,7198838.13265282,-1273891.86734712,-15714867.5340138,-5603814.53401381,-12516131.7006804,21891712.9659862,-8631359.86734712,-3662459.53401375,-9263139.53401381,-13120228.7369618,-21866542.0113381,-6827179.17800468,5141784.15532857,15082661.1553286,-8119403.51133806,4771630.48866194,-7989120.67800474,-10485197.0113381,-366710.844671369,-6778610.511338,-17797410.5113381,-12622408.7142861,-12011800.9886624,-2004720.15532893,-10773460.8219957,-23476645.8219957,-7777150.4886623,-20882671.4886623,3529833.34467101,-18989904.9886623,-11894320.8219956,6444041.5113377,-1217063.4886623,-11566797.6916103,9663832.03401339,9204673.86734682,4872726.20068008,5292624.20068008,15308855.5340135,-89251.4659865499,12726600.3673468,13276316.0340135,4589154.20068014,7286137.53401345,13325129.5340135,7990544.33106542,8838654.05668914,-8276435.10997742,-9559936.77664417,-5867435.77664417,6424978.5566892,13008586.5566892,-1783340.60997748,-11480684.9433108,12739251.2233559,-4349942.4433108,16033294.5566892,5590172.35374117],"marker":{"color":"rgb(227, 119, 194)","line":{"color":"rgba(227,119,194,1)"}},"name":"Residauls Dist.","type":"histogram","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x3","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Index","anchor":"y","range":["2008-01-01","2014-01-01"]},"xaxis2":{"domain":[0,0.46],"automargin":true,"title":"Lag","anchor":"y4"},"xaxis3":{"domain":[0.54,1],"automargin":true,"title":"Residuals Distribution","anchor":"y3"},"yaxis3":{"domain":[0,0.36],"automargin":true,"title":"Count","anchor":"x3"},"yaxis4":{"domain":[0,0.36],"automargin":true,"title":"ACF","anchor":"x2"},"yaxis":{"domain":[0.44,0.7088],"automargin":true,"title":"Residuals","anchor":"x"},"yaxis2":{"domain":[0.7312,1],"automargin":true,"title":"Fitted vs. Actuals","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":false,"title":"Residuals Analysis"},"attrs":{"1039636e6c45":{"x":{},"y":{},"mode":"lines","name":"Actual","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1039636e6c45.1":{"x":{},"y":{},"mode":"lines","name":"Fitted","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"dash":"dash","color":"red"},"inherit":true},"103966865902":{"x":{},"y":{},"mode":"lines","line":{"color":"green"},"name":"Residuals","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"10397e3dc6e3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"bar","width":0.01,"showlegend":false,"marker":{"color":"#00526d","line":{"color":"#00526d"}},"name":"Autocorrelation","inherit":true},"10397e3dc6e3.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"dash":"dash","color":"red","width":1},"showlegend":false,"name":"CI Upper","inherit":true},"10397e3dc6e3.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"dash":"dash","color":"red","width":1},"showlegend":false,"name":"CI Lower","inherit":true},"10399cca1d5":{"x":[14097431.2176867,11634595.9433104,9652325.77664381,3120049.10997707,10242688.1099771,9877587.44331044,8795520.44331044,6032159.27664381,5787757.94331044,3563986.10997713,1060833.4433105,-1080810.55668956,9631287.24036241,3741260.96598619,-1748665.20068043,7198838.13265282,-1273891.86734712,-15714867.5340138,-5603814.53401381,-12516131.7006804,21891712.9659862,-8631359.86734712,-3662459.53401375,-9263139.53401381,-13120228.7369618,-21866542.0113381,-6827179.17800468,5141784.15532857,15082661.1553286,-8119403.51133806,4771630.48866194,-7989120.67800474,-10485197.0113381,-366710.844671369,-6778610.511338,-17797410.5113381,-12622408.7142861,-12011800.9886624,-2004720.15532893,-10773460.8219957,-23476645.8219957,-7777150.4886623,-20882671.4886623,3529833.34467101,-18989904.9886623,-11894320.8219956,6444041.5113377,-1217063.4886623,-11566797.6916103,9663832.03401339,9204673.86734682,4872726.20068008,5292624.20068008,15308855.5340135,-89251.4659865499,12726600.3673468,13276316.0340135,4589154.20068014,7286137.53401345,13325129.5340135,7990544.33106542,8838654.05668914,-8276435.10997742,-9559936.77664417,-5867435.77664417,6424978.5566892,13008586.5566892,-1783340.60997748,-11480684.9433108,12739251.2233559,-4349942.4433108,16033294.5566892,5590172.35374117],"marker":{"color":"rgb(227, 119, 194)"},"name":"Residauls Dist.","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,".hideLegend":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>It appears there is a bit of residual correlations, so lets see if we can improve the model by accounting for the lag.</p>
<pre class="r"><code>lm2  &lt;- trainLM(input = tsibble,
               y = &quot;avg&quot;,
               trend = list(linear = TRUE),
               seasonal = &quot;month&quot;, 
               lags = c(1))</code></pre>
<pre class="r"><code>summary(lm2$model)</code></pre>
<pre><code>## 
## Call:
## stats::lm(formula = f, data = df1)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -20299890  -7509728    581799   7354108  26464076 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.478e+08  4.049e+07   6.121 8.61e-08 ***
## monthFeb     -2.329e+07  7.403e+06  -3.146 0.002610 ** 
## monthMar      2.833e+07  6.654e+06   4.257 7.67e-05 ***
## monthApr      8.695e+06  1.004e+07   0.866 0.390233    
## monthMay      2.624e+07  9.667e+06   2.715 0.008726 ** 
## monthJun      2.572e+07  1.124e+07   2.288 0.025818 *  
## monthJul      1.607e+07  1.174e+07   1.368 0.176502    
## monthAug      6.162e+06  1.093e+07   0.564 0.575050    
## monthSep     -1.554e+07  9.717e+06  -1.600 0.115142    
## monthOct     -1.281e+07  7.590e+06  -1.687 0.096921 .  
## monthNov     -3.875e+07  7.212e+06  -5.372 1.44e-06 ***
## monthDec     -3.063e+07  6.285e+06  -4.874 8.86e-06 ***
## linear_trend -4.401e+05  1.060e+05  -4.152 0.000109 ***
## lag_1         3.334e-01  1.220e-01   2.733 0.008296 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10880000 on 58 degrees of freedom
## Multiple R-squared:  0.9166, Adjusted R-squared:  0.898 
## F-statistic: 49.06 on 13 and 58 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>plot_res(lm2)</code></pre>
<div id="htmlwidget-5" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"data":[{"x":["2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[374165152,355687578,399855819,388639443,411307544,415161326,405393784,389391266,362587470,353803777,322733711,318741733,361377478,339472713,380133298,384396702,391469434,381247341,382672919,362521445,370369895,333286901,309688888,302237874,330304432,305543380,366733254,374018118,399504457,380521275,384726834,358726926,329671455,333230020,298251207,285382073,322480722,307076591,363234183,349781343,352623620,372541998,350751002,361924350,312845217,313380880,303152329,293640890,315214803,320430694,366122047,357106000,373071360,387306474,363222892,362799587,336789908,321542825,295672895,299861553,326450615,311283986,340319408,334351807,353589770,370101067,367999200,339968116,303711377,321371392,275715285,294248188,315728713],"mode":"lines","name":"Actual","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[348399174.741656,393417827.413066,388072767.979986,401440134.224029,408033960.661261,399226747.980336,385626791.128781,358145992.557101,351504579.204165,322196180.437872,319511205.396472,348371179.667465,338854495.10022,382730399.147702,376215761.168455,394744642.278088,396138412.323831,382637797.148898,372770028.69229,343905819.111496,348818709.686333,310074307.126878,309880783.038656,337587390.418478,323212815.410926,366136330.741586,366466895.365573,386003239.805161,393536768.055454,377114891.007791,368174068.105807,337359780.485698,329967577.781429,304774531.309673,300786239.570857,326686251.060844,315323299.730364,361366748.731764,360019369.7189,372641018.505567,372624202.847203,369173503.699654,351564495.262306,333145106.887946,319076295.790241,292875305.173916,297139640.102937,324159227.753348,307619771.611537,360538676.858554,355701477.694156,369802512.688188,374161404.43567,368815700.861632,350442261.875553,328156132.704452,321779506.493227,290315981.260853,289364918.411169,320952610.668075,306085385.405297,352208026.107329,341817141.07293,356934637.498967,362384732.676581,357797990.301688,346754044.935263,315262490.253308,305469126.044605,284978009.690808,277429524.47991,313800103.431792],"mode":"lines","name":"Fitted","type":"scatter","line":{"color":"red","dash":"dash"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[7288403.25834382,6437991.58693361,566675.020014167,9867409.77597088,7127365.3387385,6167036.01966399,3764474.8712188,4441477.44289851,2299197.79583454,537530.562128127,-769472.396472037,13006298.3325353,618217.899779558,-2597101.14770216,8180940.8315447,-3275208.27808815,-14891071.3238308,35121.8511016369,-10248583.6922902,26464075.8885044,-15531808.6863327,-385419.12687844,-7642909.03865576,-7282958.41847754,-17669435.4109264,596923.25841403,7551222.63442731,13501217.1948386,-13015493.0554537,7611942.99220908,-9447142.10580671,-7688325.48569763,3262442.21857136,-6523324.30967295,-15404166.5708569,-4205529.06084383,-8246708.73036414,1867434.26823634,-10238026.7189003,-20017398.5055666,-82204.8472031951,-18422501.6996542,10359854.737694,-20299889.8879462,-5695415.79024148,10277023.8260835,-3498750.10293657,-8944424.75334793,12810922.3884632,5583370.14144635,1404522.30584365,3268847.3118124,13145069.5643299,-5592808.86163241,12357325.1244472,8633775.29554844,-236681.493226588,5356913.73914742,10496634.5888309,5498004.33192527,5198600.59470284,-11888618.1073286,-7465334.07292962,-3344867.49896747,7716334.32341903,10201209.6983116,-6785928.9352631,-11551113.2533076,15902265.9553945,-9262724.69080794,16818663.5200903,1928609.56820846],"mode":"lines","line":{"color":"green"},"name":"Residuals","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[1,-0.101289536826226,0.178711737980437,0.0863376529049439,0.117175871485634,0.0802659790080488,0.176973882762771,0.0180363321823039,0.204061825623267,-0.17653945971638,0.167393091369312,-0.102081745964492,-0.065682782321495,0.0226532010142633,-0.0920164999301697,-0.0273125340817641,0.0536769473203515,-0.157871106084583,0.0352289479585346,0.0206817846211023,-0.0930816045026889,-0.063500819581696,-0.0514616536326213,0.205371148871077,-0.237287873196426,-0.043992892860997,0.0536474473754892,-0.14578768185331,0.00252590633451535,-0.108457935635606,-0.143867742307577,-0.0347312235356371,-0.171949505874354,0.00994548818439343,-0.19690683070824,-0.0987441975348699,-0.142926874059602],"type":"bar","width":[0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01],"showlegend":false,"marker":{"color":"#00526d","line":{"color":"#00526d"}},"name":"Autocorrelation","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":1},"showlegend":false,"name":"CI Upper","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":1},"showlegend":false,"name":"CI Lower","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[7288403.25834382,6437991.58693361,566675.020014167,9867409.77597088,7127365.3387385,6167036.01966399,3764474.8712188,4441477.44289851,2299197.79583454,537530.562128127,-769472.396472037,13006298.3325353,618217.899779558,-2597101.14770216,8180940.8315447,-3275208.27808815,-14891071.3238308,35121.8511016369,-10248583.6922902,26464075.8885044,-15531808.6863327,-385419.12687844,-7642909.03865576,-7282958.41847754,-17669435.4109264,596923.25841403,7551222.63442731,13501217.1948386,-13015493.0554537,7611942.99220908,-9447142.10580671,-7688325.48569763,3262442.21857136,-6523324.30967295,-15404166.5708569,-4205529.06084383,-8246708.73036414,1867434.26823634,-10238026.7189003,-20017398.5055666,-82204.8472031951,-18422501.6996542,10359854.737694,-20299889.8879462,-5695415.79024148,10277023.8260835,-3498750.10293657,-8944424.75334793,12810922.3884632,5583370.14144635,1404522.30584365,3268847.3118124,13145069.5643299,-5592808.86163241,12357325.1244472,8633775.29554844,-236681.493226588,5356913.73914742,10496634.5888309,5498004.33192527,5198600.59470284,-11888618.1073286,-7465334.07292962,-3344867.49896747,7716334.32341903,10201209.6983116,-6785928.9352631,-11551113.2533076,15902265.9553945,-9262724.69080794,16818663.5200903,1928609.56820846],"marker":{"color":"rgb(227, 119, 194)","line":{"color":"rgba(227,119,194,1)"}},"name":"Residauls Dist.","type":"histogram","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x3","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Index","anchor":"y","range":["2008-01-01","2014-01-01"]},"xaxis2":{"domain":[0,0.46],"automargin":true,"title":"Lag","anchor":"y4"},"xaxis3":{"domain":[0.54,1],"automargin":true,"title":"Residuals Distribution","anchor":"y3"},"yaxis3":{"domain":[0,0.36],"automargin":true,"title":"Count","anchor":"x3"},"yaxis4":{"domain":[0,0.36],"automargin":true,"title":"ACF","anchor":"x2"},"yaxis":{"domain":[0.44,0.7088],"automargin":true,"title":"Residuals","anchor":"x"},"yaxis2":{"domain":[0.7312,1],"automargin":true,"title":"Fitted vs. Actuals","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":false,"title":"Residuals Analysis"},"attrs":{"10395496f585":{"x":{},"y":{},"mode":"lines","name":"Actual","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"10395496f585.1":{"x":{},"y":{},"mode":"lines","name":"Fitted","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"dash":"dash","color":"red"},"inherit":true},"10392d11a26":{"x":{},"y":{},"mode":"lines","line":{"color":"green"},"name":"Residuals","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"10396e0bb63b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"bar","width":0.01,"showlegend":false,"marker":{"color":"#00526d","line":{"color":"#00526d"}},"name":"Autocorrelation","inherit":true},"10396e0bb63b.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"dash":"dash","color":"red","width":1},"showlegend":false,"name":"CI Upper","inherit":true},"10396e0bb63b.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"dash":"dash","color":"red","width":1},"showlegend":false,"name":"CI Lower","inherit":true},"103942e913ee":{"x":[7288403.25834382,6437991.58693361,566675.020014167,9867409.77597088,7127365.3387385,6167036.01966399,3764474.8712188,4441477.44289851,2299197.79583454,537530.562128127,-769472.396472037,13006298.3325353,618217.899779558,-2597101.14770216,8180940.8315447,-3275208.27808815,-14891071.3238308,35121.8511016369,-10248583.6922902,26464075.8885044,-15531808.6863327,-385419.12687844,-7642909.03865576,-7282958.41847754,-17669435.4109264,596923.25841403,7551222.63442731,13501217.1948386,-13015493.0554537,7611942.99220908,-9447142.10580671,-7688325.48569763,3262442.21857136,-6523324.30967295,-15404166.5708569,-4205529.06084383,-8246708.73036414,1867434.26823634,-10238026.7189003,-20017398.5055666,-82204.8472031951,-18422501.6996542,10359854.737694,-20299889.8879462,-5695415.79024148,10277023.8260835,-3498750.10293657,-8944424.75334793,12810922.3884632,5583370.14144635,1404522.30584365,3268847.3118124,13145069.5643299,-5592808.86163241,12357325.1244472,8633775.29554844,-236681.493226588,5356913.73914742,10496634.5888309,5498004.33192527,5198600.59470284,-11888618.1073286,-7465334.07292962,-3344867.49896747,7716334.32341903,10201209.6983116,-6785928.9352631,-11551113.2533076,15902265.9553945,-9262724.69080794,16818663.5200903,1928609.56820846],"marker":{"color":"rgb(227, 119, 194)"},"name":"Residauls Dist.","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,".hideLegend":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>events &lt;- list(outlier = c(as_date(&quot;2009-01-01&quot;), as_date(&quot;2009-09-01&quot;), as_date(&quot;2010-05-01&quot;), as_date(&quot;2010-12-01&quot;), as_date(&quot;2014-12-01&quot;), as_date(&quot;2011-09-01&quot;)))
lm3  &lt;- trainLM(input = seasonal,
               y = &quot;avg&quot;,
               trend = list(log = TRUE),
               seasonal = &quot;month&quot;, 
               lags = c(1),
               step = TRUE,
               events = events)</code></pre>
<pre><code>## Start:  AIC=2336.84
## seasonal ~ outlier + month + log_trend + lag_1
## 
##             Df  Sum of Sq        RSS    AIC
## &lt;none&gt;                    5.9137e+15 2336.8
## - lag_1      1 1.8632e+14 6.1000e+15 2337.1
## - outlier    1 2.3079e+14 6.1445e+15 2337.6
## - log_trend  1 2.7524e+15 8.6661e+15 2362.3
## - month     11 2.8984e+16 3.4898e+16 2442.7</code></pre>
<pre class="r"><code>               #scale = &quot;log&quot;)</code></pre>
<pre class="r"><code>summary(lm3$model)</code></pre>
<pre><code>## 
## Call:
## stats::lm(formula = seasonal ~ outlier + month + log_trend + 
##     lag_1, data = df1)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -23314268  -6965692   1420787   6286031  22956868 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.288e+08  4.755e+07   6.914 4.43e-09 ***
## outlier      7.789e+06  5.222e+06   1.491  0.14135    
## monthFeb    -1.915e+07  7.063e+06  -2.711  0.00885 ** 
## monthMar     3.100e+07  6.319e+06   4.906 8.14e-06 ***
## monthApr     1.948e+07  1.007e+07   1.935  0.05801 .  
## monthMay     3.545e+07  9.634e+06   3.679  0.00052 ***
## monthJun     3.910e+07  1.145e+07   3.415  0.00118 ** 
## monthJul     3.042e+07  1.202e+07   2.531  0.01416 *  
## monthAug     1.934e+07  1.115e+07   1.734  0.08840 .  
## monthSep    -6.928e+06  9.783e+06  -0.708  0.48170    
## monthOct    -5.752e+06  7.473e+06  -0.770  0.44465    
## monthNov    -3.265e+07  7.042e+06  -4.637 2.11e-05 ***
## monthDec    -3.038e+07  5.883e+06  -5.164 3.21e-06 ***
## log_trend   -1.463e+07  2.841e+06  -5.151 3.36e-06 ***
## lag_1        1.719e-01  1.283e-01   1.340  0.18553    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10190000 on 57 degrees of freedom
## Multiple R-squared:  0.9282, Adjusted R-squared:  0.9106 
## F-statistic: 52.66 on 14 and 57 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>plot_res(lm3)</code></pre>
<div id="htmlwidget-6" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6">{"x":{"data":[{"x":["2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[374165152,355687578,399855819,388639443,411307544,415161326,405393784,389391266,362587470,353803777,322733711,318741733,361377478,339472713,380133298,384396702,391469434,381247341,382672919,362521445,370369895,333286901,309688888,302237874,330304432,305543380,366733254,374018118,399504457,380521275,384726834,358726926,329671455,333230020,298251207,285382073,322480722,307076591,363234183,349781343,352623620,372541998,350751002,361924350,312845217,313380880,303152329,293640890,315214803,320430694,366122047,357106000,373071360,387306474,363222892,362799587,336789908,321542825,295672895,299861553,326450615,311283986,340319408,334351807,353589770,370101067,367999200,339968116,303711377,321371392,275715285,294248188,315728713],"mode":"lines","name":"Actual","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[363811662.70411,404845926.272723,396707054.355556,407488631.2757,412370731.227789,402093603.53935,387378977.642865,356639702.702379,351666845.038745,321863393.825851,317522606.566331,353832267.658714,333142780.41575,378510851.300791,373033838.227706,388854199.139741,392886733.520424,381654298.294115,370066990.547697,347413027.329544,341468686.580481,307544717.656585,305138746.421898,333638564.846992,318744158.587603,364078493.046041,362542619.080047,387045022.288543,386794037.688368,374366888.109763,363543414.856156,332358662.829484,328103497.936778,301392041.188214,305029317.64438,325005081.194715,311846940.456199,358961854.710558,356722605.727334,370023279.855041,373812316.91359,368207790.79847,353043684.549626,336159485.07882,320788396.138046,293666764.399426,293873652.130027,322314871.626017,306582637.624574,357332434.030093,353380365.2418,367526304.565771,373650276.955098,367144610.558139,351659141.530756,325062247.131603,321512972.292871,291742846.798202,289323120.498391,320179217.454229,305366762.211766,352668449.639796,345906930.367558,360628747.875205,367365384.694732,361299439.700164,349639480.872902,318342196.928171,313075397.01308,289004551.131723,283224867.738974,316586760.219333],"mode":"lines","name":"Fitted","type":"scatter","line":{"color":"red","dash":"dash"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":["2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[-8124084.70410985,-4990107.27272284,-8067611.35555601,3818912.72430027,2790594.77221107,3300180.46065009,2012288.3571353,5947767.29762101,2136931.96125507,870317.17414856,1219126.43366855,7545210.34128612,6329932.58425009,1622446.69920921,11362863.7722943,2615234.86025888,-11639392.5204235,1018620.70588511,-7545545.54769659,22956867.6704565,-8181785.58048069,2144170.34341514,-2900872.42189842,-3334132.84699208,-13200778.5876032,2654760.95395929,11475498.919953,12459434.7114567,-6272762.68836808,10359945.8902375,-4816488.85615581,-2687207.82948434,5126522.06322187,-3140834.18821359,-19647244.6443799,-2524359.1947149,-4770349.45619893,4272328.28944194,-6941262.72733408,-17399659.855041,-1270318.91359007,-17456788.7984705,8880665.45037436,-23314268.0788205,-7407516.13804579,9485564.60057396,-232762.130026579,-7100068.62601721,13848056.3754259,8789612.9699074,3725634.75819975,5545055.43422937,13656197.0449017,-3921718.55813879,11140445.4692435,11727660.8683971,29852.7071287036,3930048.2017979,10538432.501609,6271397.5457707,5917223.78823394,-12349041.6397955,-11555123.367558,-7038977.8752051,2735682.30526793,6699760.29983574,-9671364.87290162,-14630819.9281708,8295994.98692,-13289266.1317227,11023320.2610264,-858047.21933341],"mode":"lines","line":{"color":"green"},"name":"Residuals","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[1,-0.0143495285467922,0.135831093320825,0.0583379962479403,0.116783004018201,0.0476965283534917,0.107809772118353,-0.00605080574552602,-0.00401221941695832,-0.177387605909809,0.0616232039404563,-0.23119280308032,-0.16187358234381,-0.0729195226123909,-0.192994448132229,-0.138864928843137,-0.0142559309436229,-0.196043904565609,-0.0078135840952115,0.0175105701893075,-0.0397330379278023,-0.0761037545855134,0.0311380157923661,0.273576015488605,-0.179922020438067,-0.0317836784380163,0.0561831615635215,-0.0843930852129948,0.117054530304596,-0.0573028791284104,-0.0367540371100698,-0.015349064648762,-0.0496243037023667,0.122130877417247,-0.078959197818011,-0.0116667235895519,-0.0713439349734291],"type":"bar","width":[0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01,0.01],"showlegend":false,"marker":{"color":"#00526d","line":{"color":"#00526d"}},"name":"Autocorrelation","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946,0.230983970724946],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":1},"showlegend":false,"name":"CI Upper","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],"y":[-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946,-0.230983970724946],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash","width":1},"showlegend":false,"name":"CI Lower","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x2","yaxis":"y4","frame":null},{"x":[-8124084.70410985,-4990107.27272284,-8067611.35555601,3818912.72430027,2790594.77221107,3300180.46065009,2012288.3571353,5947767.29762101,2136931.96125507,870317.17414856,1219126.43366855,7545210.34128612,6329932.58425009,1622446.69920921,11362863.7722943,2615234.86025888,-11639392.5204235,1018620.70588511,-7545545.54769659,22956867.6704565,-8181785.58048069,2144170.34341514,-2900872.42189842,-3334132.84699208,-13200778.5876032,2654760.95395929,11475498.919953,12459434.7114567,-6272762.68836808,10359945.8902375,-4816488.85615581,-2687207.82948434,5126522.06322187,-3140834.18821359,-19647244.6443799,-2524359.1947149,-4770349.45619893,4272328.28944194,-6941262.72733408,-17399659.855041,-1270318.91359007,-17456788.7984705,8880665.45037436,-23314268.0788205,-7407516.13804579,9485564.60057396,-232762.130026579,-7100068.62601721,13848056.3754259,8789612.9699074,3725634.75819975,5545055.43422937,13656197.0449017,-3921718.55813879,11140445.4692435,11727660.8683971,29852.7071287036,3930048.2017979,10538432.501609,6271397.5457707,5917223.78823394,-12349041.6397955,-11555123.367558,-7038977.8752051,2735682.30526793,6699760.29983574,-9671364.87290162,-14630819.9281708,8295994.98692,-13289266.1317227,11023320.2610264,-858047.21933341],"marker":{"color":"rgb(227, 119, 194)","line":{"color":"rgba(227,119,194,1)"}},"name":"Residauls Dist.","type":"histogram","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x3","yaxis":"y3","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"title":"Index","anchor":"y","range":["2008-01-01","2014-01-01"]},"xaxis2":{"domain":[0,0.46],"automargin":true,"title":"Lag","anchor":"y4"},"xaxis3":{"domain":[0.54,1],"automargin":true,"title":"Residuals Distribution","anchor":"y3"},"yaxis3":{"domain":[0,0.36],"automargin":true,"title":"Count","anchor":"x3"},"yaxis4":{"domain":[0,0.36],"automargin":true,"title":"ACF","anchor":"x2"},"yaxis":{"domain":[0.44,0.7088],"automargin":true,"title":"Residuals","anchor":"x"},"yaxis2":{"domain":[0.7312,1],"automargin":true,"title":"Fitted vs. Actuals","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":false,"title":"Residuals Analysis"},"attrs":{"1039922ae06":{"x":{},"y":{},"mode":"lines","name":"Actual","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1039922ae06.1":{"x":{},"y":{},"mode":"lines","name":"Fitted","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","line":{"dash":"dash","color":"red"},"inherit":true},"103943cf1099":{"x":{},"y":{},"mode":"lines","line":{"color":"green"},"name":"Residuals","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"10394f4acf96":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"bar","width":0.01,"showlegend":false,"marker":{"color":"#00526d","line":{"color":"#00526d"}},"name":"Autocorrelation","inherit":true},"10394f4acf96.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"dash":"dash","color":"red","width":1},"showlegend":false,"name":"CI Upper","inherit":true},"10394f4acf96.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"dash":"dash","color":"red","width":1},"showlegend":false,"name":"CI Lower","inherit":true},"10393882a985":{"x":[-8124084.70410985,-4990107.27272284,-8067611.35555601,3818912.72430027,2790594.77221107,3300180.46065009,2012288.3571353,5947767.29762101,2136931.96125507,870317.17414856,1219126.43366855,7545210.34128612,6329932.58425009,1622446.69920921,11362863.7722943,2615234.86025888,-11639392.5204235,1018620.70588511,-7545545.54769659,22956867.6704565,-8181785.58048069,2144170.34341514,-2900872.42189842,-3334132.84699208,-13200778.5876032,2654760.95395929,11475498.919953,12459434.7114567,-6272762.68836808,10359945.8902375,-4816488.85615581,-2687207.82948434,5126522.06322187,-3140834.18821359,-19647244.6443799,-2524359.1947149,-4770349.45619893,4272328.28944194,-6941262.72733408,-17399659.855041,-1270318.91359007,-17456788.7984705,8880665.45037436,-23314268.0788205,-7407516.13804579,9485564.60057396,-232762.130026579,-7100068.62601721,13848056.3754259,8789612.9699074,3725634.75819975,5545055.43422937,13656197.0449017,-3921718.55813879,11140445.4692435,11727660.8683971,29852.7071287036,3930048.2017979,10538432.501609,6271397.5457707,5917223.78823394,-12349041.6397955,-11555123.367558,-7038977.8752051,2735682.30526793,6699760.29983574,-9671364.87290162,-14630819.9281708,8295994.98692,-13289266.1317227,11023320.2610264,-858047.21933341],"marker":{"color":"rgb(227, 119, 194)"},"name":"Residauls Dist.","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"histogram"}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,".hideLegend":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Now that we have a prediction model that accounts for roughly 87% of the variability, we can look and see what this may have looked like with somewhat clean data or consistent reporting.</p>
<pre class="r"><code># Using the lm3 prediction model. 
fc3 &lt;- forecastLM(lm3, h = 24)</code></pre>
<pre class="r"><code># Plot it.
plot_fc(fc3, theme = &#39;darkBlue&#39;)</code></pre>
<div id="htmlwidget-7" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7">{"x":{"visdat":{"1039696d23fe":["function () ","plotlyVisDat"]},"cur_data":"1039696d23fe","attrs":{"1039696d23fe":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines","line":{"color":"white"},"name":"Actual","inherit":true},"1039696d23fe.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01"],"ymin":[278580467.241088,326026093.36788,322487212.686555,337630600.637152,343767389.602501,335957259.765282,323358653.899468,294516222.081035,290836167.103746,263101377.02371,266503561.078222,291398303.47226,275948657.799906,323341800.934099,319823349.37328,335001796.535705,341169814.540349,333392019.792269,320825176.172839,292019110.162728,288364665.817095,260658376.243541,257971708.422273,287752377.994437],"ymax":[323289522.102926,370650894.756164,367054902.006214,382251490.516999,388258588.905969,380415063.434425,367790957.389439,339403783.876792,335239521.5881,307473075.679331,314304377.690576,336000130.930555,320826023.805529,368116229.246785,364531707.471526,379750588.182624,385786942.649109,377970908.639068,365373598.485305,337007284.149701,332873330.189958,305133037.897097,302528469.557373,332290824.772603],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"rgba( 66,134,244 0.6 )"},"fillcolor":"rgba( 66,134,244 0.6 )","name":"95% PI","inherit":true},"1039696d23fe.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01"],"ymin":[286460609.420799,333891385.55014,330342438.64795,345495203.401067,351609133.905542,343793117.95985,331190017.589777,302427826.79163,298662428.420925,270922058.879816,274928638.109613,299259546.411357,283858465.463433,331233465.434939,327703368.74574,342888942.476001,349033754.2777,341249219.713222,328677006.250412,299948448.157425,296209488.405518,268497205.722437,265825008.249278,295602449.845878],"ymax":[315409379.923215,362785602.573904,359199676.04482,374386887.753084,380416844.602927,372579205.239857,359959593.69913,331492179.166198,327413260.270921,299652393.823225,305879300.659186,328138887.991458,312916216.142001,360224564.745946,356651688.099067,371863442.242328,377923002.911758,370113708.718115,357521768.407732,329077946.155005,325028507.601534,297294208.418201,294675169.730368,324440752.921162],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"rgba( 66,134,244 0.8 )"},"fillcolor":"rgba( 66,134,244 0.8 )","name":"80% PI","inherit":true},"1039696d23fe.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01"],"y":[300934994.672007,348338494.062022,344771057.346385,359941045.577075,366012989.254235,358186161.599854,345574805.644453,316960002.978914,313037844.345923,285287226.351521,290403969.384399,313699217.201408,298387340.802717,345729015.090442,342177528.422403,357376192.359165,363478378.594729,355681464.215669,343099387.329072,314513197.156215,310618998.003526,282895707.070319,280250088.989823,310021601.38352],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"white","dash":"dash"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"seasonal Forecast <br>Horizon -  24","paper_bgcolor":"black","plot_bgcolor":"black","font":{"color":"white"},"yaxis":{"domain":[0,1],"automargin":true,"title":"seasonal","linecolor":"#6b6b6b","zerolinecolor":"#6b6b6b","gridcolor":"#444444"},"xaxis":{"domain":[0,1],"automargin":true,"title":"index","linecolor":"#6b6b6b","zerolinecolor":"#6b6b6b","gridcolor":"#444444"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2008-01-01","2008-02-01","2008-03-01","2008-04-01","2008-05-01","2008-06-01","2008-07-01","2008-08-01","2008-09-01","2008-10-01","2008-11-01","2008-12-01","2009-01-01","2009-02-01","2009-03-01","2009-04-01","2009-05-01","2009-06-01","2009-07-01","2009-08-01","2009-09-01","2009-10-01","2009-11-01","2009-12-01","2010-01-01","2010-02-01","2010-03-01","2010-04-01","2010-05-01","2010-06-01","2010-07-01","2010-08-01","2010-09-01","2010-10-01","2010-11-01","2010-12-01","2011-01-01","2011-02-01","2011-03-01","2011-04-01","2011-05-01","2011-06-01","2011-07-01","2011-08-01","2011-09-01","2011-10-01","2011-11-01","2011-12-01","2012-01-01","2012-02-01","2012-03-01","2012-04-01","2012-05-01","2012-06-01","2012-07-01","2012-08-01","2012-09-01","2012-10-01","2012-11-01","2012-12-01","2013-01-01","2013-02-01","2013-03-01","2013-04-01","2013-05-01","2013-06-01","2013-07-01","2013-08-01","2013-09-01","2013-10-01","2013-11-01","2013-12-01","2014-01-01"],"y":[374165152,355687578,399855819,388639443,411307544,415161326,405393784,389391266,362587470,353803777,322733711,318741733,361377478,339472713,380133298,384396702,391469434,381247341,382672919,362521445,370369895,333286901,309688888,302237874,330304432,305543380,366733254,374018118,399504457,380521275,384726834,358726926,329671455,333230020,298251207,285382073,322480722,307076591,363234183,349781343,352623620,372541998,350751002,361924350,312845217,313380880,303152329,293640890,315214803,320430694,366122047,357106000,373071360,387306474,363222892,362799587,336789908,321542825,295672895,299861553,326450615,311283986,340319408,334351807,353589770,370101067,367999200,339968116,303711377,321371392,275715285,294248188,315728713],"type":"scatter","mode":"lines","line":{"color":"white"},"name":"Actual","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba( 66,134,244 0.6 )","x":["2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-01-01","2016-01-01","2015-12-01","2015-11-01","2015-10-01","2015-09-01","2015-08-01","2015-07-01","2015-06-01","2015-05-01","2015-04-01","2015-03-01","2015-02-01","2015-01-01","2014-12-01","2014-11-01","2014-10-01","2014-09-01","2014-08-01","2014-07-01","2014-06-01","2014-05-01","2014-04-01","2014-03-01","2014-02-01"],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"rgba( 66,134,244 0.6 )"},"name":"95% PI","y":[278580467.241088,326026093.36788,322487212.686555,337630600.637152,343767389.602501,335957259.765282,323358653.899468,294516222.081035,290836167.103746,263101377.02371,266503561.078222,291398303.47226,275948657.799906,323341800.934099,319823349.37328,335001796.535705,341169814.540349,333392019.792269,320825176.172839,292019110.162728,288364665.817095,260658376.243541,257971708.422273,287752377.994437,287752377.994437,332290824.772603,302528469.557373,305133037.897097,332873330.189958,337007284.149701,365373598.485305,377970908.639068,385786942.649109,379750588.182624,364531707.471526,368116229.246785,320826023.805529,336000130.930555,314304377.690576,307473075.679331,335239521.5881,339403783.876792,367790957.389439,380415063.434425,388258588.905969,382251490.516999,367054902.006214,370650894.756164,323289522.102926],"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba( 66,134,244 0.8 )","x":["2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01","2016-01-01","2016-01-01","2015-12-01","2015-11-01","2015-10-01","2015-09-01","2015-08-01","2015-07-01","2015-06-01","2015-05-01","2015-04-01","2015-03-01","2015-02-01","2015-01-01","2014-12-01","2014-11-01","2014-10-01","2014-09-01","2014-08-01","2014-07-01","2014-06-01","2014-05-01","2014-04-01","2014-03-01","2014-02-01"],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","line":{"color":"rgba( 66,134,244 0.8 )"},"name":"80% PI","y":[286460609.420799,333891385.55014,330342438.64795,345495203.401067,351609133.905542,343793117.95985,331190017.589777,302427826.79163,298662428.420925,270922058.879816,274928638.109613,299259546.411357,283858465.463433,331233465.434939,327703368.74574,342888942.476001,349033754.2777,341249219.713222,328677006.250412,299948448.157425,296209488.405518,268497205.722437,265825008.249278,295602449.845878,295602449.845878,324440752.921162,294675169.730368,297294208.418201,325028507.601534,329077946.155005,357521768.407732,370113708.718115,377923002.911758,371863442.242328,356651688.099067,360224564.745946,312916216.142001,328138887.991458,305879300.659186,299652393.823225,327413260.270921,331492179.166198,359959593.69913,372579205.239857,380416844.602927,374386887.753084,359199676.04482,362785602.573904,315409379.923215],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-02-01","2014-03-01","2014-04-01","2014-05-01","2014-06-01","2014-07-01","2014-08-01","2014-09-01","2014-10-01","2014-11-01","2014-12-01","2015-01-01","2015-02-01","2015-03-01","2015-04-01","2015-05-01","2015-06-01","2015-07-01","2015-08-01","2015-09-01","2015-10-01","2015-11-01","2015-12-01","2016-01-01"],"y":[300934994.672007,348338494.062022,344771057.346385,359941045.577075,366012989.254235,358186161.599854,345574805.644453,316960002.978914,313037844.345923,285287226.351521,290403969.384399,313699217.201408,298387340.802717,345729015.090442,342177528.422403,357376192.359165,363478378.594729,355681464.215669,343099387.329072,314513197.156215,310618998.003526,282895707.070319,280250088.989823,310021601.38352],"type":"scatter","mode":"lines","name":"Forecast","line":{"color":"white","dash":"dash"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>library(forecast)</code></pre>
